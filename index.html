<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#171411" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Rental Property Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Great+Vibes&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="icon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="styles.css?v=20260214cs" />
  </head>
  <body>
    <header class="site-header">
      <h1 class="brand-title">Veeramma</h1>
      <h2 class="brand-subtitle">RESIDENCY</h2>
      <form id="editor-access-form" class="editor-access">
        <label for="editorPin" class="editor-login-only pin-label">Access PIN</label>
        <input type="password" id="editorPin" class="editor-login-only pin-input" placeholder="••••" maxlength="8" inputmode="numeric" />
        <button type="button" class="btn btn-small editor-login-only" id="editorLoginBtn">Login</button>
        <button type="button" class="btn btn-small btn-muted editor-login-only" id="tenantLoginBtn">Tenant Login</button>
        <button type="button" class="btn btn-small btn-muted editor-always" id="manualRefreshBtn">Refresh</button>
        <span id="editorStatus" class="editor-status editor-auth-only">View only mode</span>
        <button type="button" class="btn btn-small btn-muted editor-logout-only" id="editorLogout">Logout</button>
      </form>
    </header>

    <main class="container">
      <div class="tabs">
        <button class="tab-btn active" data-tab-target="dashboard">Dashboard</button>
        <button class="tab-btn" data-tab-target="active-tenants">Tenants</button>
        <button class="tab-btn" data-tab-target="available-units">Units</button>
        <button class="tab-btn" data-tab-target="lease-status">Tenant Payments</button>
        <button class="tab-btn" data-tab-target="maintenance">Maintenance</button>
        <button class="tab-btn" data-tab-target="service-providers">Service Providers</button>
        <button class="tab-btn hidden" data-tab-target="settings" id="settingsTabBtn">Settings</button>
      </div>

      <section class="tab-panel active" data-tab-panel="dashboard">
        <section class="card metrics" id="metrics">
          <div class="metrics-row">
            <div class="metric-box">Total Units<strong>0</strong></div>
            <div class="metric-box">Occupied Units<strong>0</strong></div>
            <div class="metric-box">Vacant Units<strong>0</strong></div>
          </div>
        </section>

        <section class="card hidden" data-always-hidden="true" id="dashboardPaymentsCard" hidden>
          <div class="table-head">
            <h2>Monthly Payments</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small btn-muted" id="expandDashboardTenants" title="Expand All" aria-label="Expand All">▼</button>
              <button type="button" class="btn btn-small btn-muted" id="collapseDashboardTenants" title="Collapse All" aria-label="Collapse All">▲</button>
              <div class="month-control">
                <label for="activeMonth">Payment Month</label>
                <div class="month-picker-modern" id="activeMonthPicker">
                  <button type="button" class="btn btn-small btn-muted month-nav-btn" id="activeMonthPrev" aria-label="Previous month">◀</button>
                  <select id="activeMonthSelect" aria-label="Select month"></select>
                  <select id="activeYearSelect" aria-label="Select year"></select>
                  <button type="button" class="btn btn-small btn-muted month-nav-btn" id="activeMonthNext" aria-label="Next month">▶</button>
                </div>
                <input type="month" id="activeMonth" class="hidden" aria-hidden="true" tabindex="-1" />
              </div>
              <button type="button" class="btn btn-small" id="exportMonthlyReport">Print</button>
            </div>
          </div>
          <div id="dashboardTenantGroups"></div>
        </section>

        <section class="card" id="messageBoardCard">
          <div class="table-head">
            <h2>Message Board</h2>
          </div>
          <form id="messageBoardForm" class="message-board-form">
            <label id="messageBoardComposeField">
              Message
              <textarea id="messageBoardText" rows="3" placeholder="Type a message for all tenants..." maxlength="1000"></textarea>
            </label>
            <div class="message-board-footer">
              <button type="button" class="btn btn-small btn-muted" id="announcementToggleBtn">Disable Announcements</button>
              <div class="actions" id="messageBoardPostActions">
                <button type="submit" class="btn btn-small" id="messageBoardPostBtn">Post Message</button>
              </div>
            </div>
          </form>
          <div id="messageBoardList"></div>
        </section>

      </section>

      <section class="tab-panel" data-tab-panel="active-tenants">
        <section class="card hidden" id="activeTenantAddCard">
          <h2>Add Tenant</h2>
          <form id="tenant-form">
            <div class="form-grid">
              <label>
                Property Name
                <select id="propertyName" required>
                  <option value="">Select Building - Unit</option>
                </select>
              </label>
              <label>
                Tenant Name
                <input type="text" id="tenantName" required placeholder="John Smith" />
              </label>
              <label>
                Tenant PIN
                <input type="password" id="tenantPin" inputmode="numeric" maxlength="8" placeholder="4-8 digits" required />
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="showTenantPin" />
                Show PIN
              </label>
              <label>
                Email
                <input type="email" id="tenantEmail" placeholder="john@email.com" />
              </label>
              <label>
                Mobile Number
                <input type="tel" id="tenantMobile" placeholder="+91 9876543210" />
              </label>
              <label>
                Monthly Rent (₹)
                <input type="number" id="monthlyRent" required min="0" step="0.01" placeholder="1500" />
              </label>
              <label>
                Lease Start Date
                <input type="date" id="leaseStart" required />
              </label>
              <label>
                Lease End Date
                <input type="date" id="leaseEnd" required />
              </label>
              <label>
                Security Deposit (₹)
                <input type="number" id="deposit" min="0" step="0.01" placeholder="Optional" />
              </label>
              <label>
                Tenant Documents
                <input
                  type="file"
                  id="tenantDocuments"
                  multiple
                  accept=".pdf,.png,.jpg,.jpeg,.doc,.docx,.txt"
                />
              </label>
              <label>
                Notes
                <textarea id="tenantNotes" rows="3" placeholder="Tenant notes..."></textarea>
              </label>
            </div>
            <div class="actions">
              <button type="submit" class="btn">Save Tenant</button>
              <button type="button" class="btn btn-muted" id="cancelAddTenant">Cancel</button>
            </div>
          </form>
        </section>

        <section class="card hidden" id="activeTenantEditCard">
          <h2>Edit Active Tenant</h2>
          <form id="activeTenantEditForm">
            <div class="form-grid">
              <label>
                Property Name
                <select id="editPropertyName" required>
                  <option value="">Select Building - Unit</option>
                </select>
              </label>
              <label>
                Tenant Name
                <input type="text" id="editTenantName" required />
              </label>
              <label>
                Tenant PIN
                <input type="password" id="editTenantPin" inputmode="numeric" maxlength="8" placeholder="4-8 digits" required />
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="showEditTenantPin" />
                Show PIN
              </label>
              <label>
                Email
                <input type="email" id="editTenantEmail" />
              </label>
              <label>
                Mobile Number
                <input type="tel" id="editTenantMobile" placeholder="+91 9876543210" />
              </label>
              <label>
                Monthly Rent (₹)
                <input type="number" id="editMonthlyRent" required min="0" step="0.01" />
              </label>
              <label>
                Security Deposit (₹)
                <input type="number" id="editDeposit" min="0" step="0.01" />
              </label>
              <label>
                Lease Start Date
                <input type="date" id="editLeaseStart" required />
              </label>
              <label>
                Lease End Date
                <input type="date" id="editLeaseEnd" required />
              </label>
              <label>
                Add Documents
                <input
                  type="file"
                  id="editTenantDocuments"
                  multiple
                  accept=".pdf,.png,.jpg,.jpeg,.doc,.docx,.txt"
                />
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="replaceDocuments" />
                Replace existing documents with new uploads
              </label>
              <div class="existing-docs" id="editExistingDocs"></div>
              <label>
                Notes
                <textarea id="editTenantNotes" rows="3" placeholder="Tenant notes..."></textarea>
              </label>
            </div>
            <div class="actions">
              <button type="submit" class="btn">Update Tenant</button>
              <button type="button" class="btn btn-muted" id="cancelTenantEdit">Cancel</button>
            </div>
          </form>
        </section>

        <section class="card">
          <div class="table-head">
            <h2>Tenants (Today: <span id="todayDate"></span>)</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small btn-muted" id="expandAllActiveTenants" title="Expand All" aria-label="Expand All">▼</button>
              <button type="button" class="btn btn-small btn-muted" id="collapseAllActiveTenants" title="Collapse All" aria-label="Collapse All">▲</button>
              <button type="button" class="btn btn-small" id="addTenantFromActive">Add Tenant</button>
            </div>
          </div>
          <div id="activeTenantGroups"></div>
        </section>
      </section>

      <section class="tab-panel hidden" data-tab-panel="settings" id="settingsPanel">
        <section class="card settings-section" id="propertyAddressSection">
          <div class="table-head">
            <h2>Property Address</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small" id="editPropertyAddressBtn">Edit</button>
              <button type="button" class="btn btn-small hidden" id="savePropertyAddressBtn">Save</button>
              <button type="button" class="btn btn-small btn-muted hidden" id="cancelPropertyAddressBtn">Cancel</button>
            </div>
          </div>
          <p>Configure building-wise landlord name and address used in rental receipts.</p>
          <div id="buildingAddressFields" class="form-grid"></div>
        </section>

        <section class="card settings-section" id="paymentOptionsSection">
          <div class="table-head">
            <h2>Payment Options</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small" id="editPaymentOptionsBtn">Edit</button>
              <button type="button" class="btn btn-small hidden" id="savePaymentOptionsBtn">Save</button>
              <button type="button" class="btn btn-small btn-muted hidden" id="cancelPaymentOptionsBtn">Cancel</button>
            </div>
          </div>
          <p>Configure building-wise payment details for tenant portal payment options.</p>
          <div id="buildingPaymentFields" class="form-grid"></div>
        </section>

        <section class="card settings-section" id="mailConfigSection">
          <div class="table-head">
            <h2>Mail Server Configurations</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small" id="editMailConfigBtn">Edit</button>
              <button type="button" class="btn btn-small hidden" id="saveMailConfigBtn">Save</button>
              <button type="button" class="btn btn-small btn-muted hidden" id="cancelMailConfigBtn">Cancel</button>
            </div>
          </div>
          <p>Configure recipient lists and EmailJS service details for reminder and review mails.</p>
          <div class="form-grid">
            <label>
              Administrator Emails
              <textarea id="adminEmailList" rows="3" placeholder="admin1@mail.com, admin2@mail.com"></textarea>
            </label>
            <label>
              Manager Emails
              <textarea id="managerEmailList" rows="3" placeholder="manager1@mail.com, manager2@mail.com"></textarea>
            </label>
            <label>
              EmailJS Public Key
              <input type="text" id="emailjsPublicKey" placeholder="public key" />
            </label>
            <label>
              EmailJS Service ID
              <input type="text" id="emailjsServiceId" placeholder="service_xxx" />
            </label>
            <label>
              EmailJS Template ID
              <input type="text" id="emailjsTemplateId" placeholder="template_xxx" />
            </label>
            <label>
              Sender Name
              <input type="text" id="notifySenderName" placeholder="Rental Management" />
            </label>
            <label>
              Review Email Subject Template
              <input
                type="text"
                id="reviewSubjectTemplate"
                placeholder="Payment Review Required: {unit} {tenant name}"
              />
            </label>
          </div>
        </section>

        <section class="card settings-section" id="accessControlSection">
          <div class="table-head">
            <h2>Access Control</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small" id="editAccessControlBtn">Edit</button>
              <button type="button" class="btn btn-small hidden" id="saveAccessControlBtn">Save</button>
              <button type="button" class="btn btn-small btn-muted hidden" id="cancelAccessControlBtn">Cancel</button>
            </div>
          </div>
          <p>Admin can control manager access on tabs and actions.</p>
          <div class="access-grid">
            <div class="access-group">
              <h3 class="subhead">Manager Tabs</h3>
              <label class="checkbox-label">
                <input type="checkbox" id="managerTabAvailableUnits" />
                Available Units Tab
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerTabActiveTenants" />
                Active Tenants Tab
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerTabLeaseStatus" />
                Lease Payment Status Tab
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerTabMaintenance" />
                Maintenance Tab
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerTabServiceProviders" />
                Service Providers Tab
              </label>
            </div>
            <div class="access-group">
              <h3 class="subhead">Manager Tenant Actions</h3>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessTenantEdit" />
                Edit Tenant
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessTenantAdd" />
                Add Tenant
              </label>
            </div>
            <div class="access-group">
              <h3 class="subhead">Manager Unit Actions</h3>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessUnitEdit" />
                Edit Unit
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessUnitAdd" />
                Add Unit
              </label>
            </div>
            <div class="access-group">
              <h3 class="subhead">Manager Maintenance Actions</h3>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessMaintenanceAdd" />
                Create Maintenance
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessMaintenanceEdit" />
                Edit Maintenance
              </label>
            </div>
            <div class="access-group">
              <h3 class="subhead">Manager Service Provider Actions</h3>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessServiceProviderAdd" />
                Create Service Provider
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="managerAccessServiceProviderEdit" />
                Edit Service Provider
              </label>
            </div>
          </div>
        </section>

        <section class="card settings-section" id="accessPinsSection">
          <div class="table-head">
            <h2>Access PINs</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small" id="editAccessPinsBtn">Edit</button>
              <button type="button" class="btn btn-small hidden" id="saveAccessPinsBtn">Save</button>
              <button type="button" class="btn btn-small btn-muted hidden" id="cancelAccessPinsBtn">Cancel</button>
            </div>
          </div>
          <p>Change login PINs for Viewer, Manager, and Admin.</p>
          <label class="checkbox-label">
            <input type="checkbox" id="showAccessPinsToggle" />
            Show PINs
          </label>
          <div class="form-grid">
            <label>
              Viewer PIN
              <input type="password" id="viewerPinSetting" inputmode="numeric" maxlength="8" placeholder="4-8 digits" />
            </label>
            <label>
              Manager PIN
              <input type="password" id="managerPinSetting" inputmode="numeric" maxlength="8" placeholder="4-8 digits" />
            </label>
            <label>
              Admin PIN
              <input type="password" id="adminPinSetting" inputmode="numeric" maxlength="8" placeholder="4-8 digits" />
            </label>
          </div>
        </section>

        <section class="card settings-section" id="themeSection">
          <div class="table-head">
            <h2>Layout Theme</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small" id="editThemeBtn">Edit</button>
              <button type="button" class="btn btn-small hidden" id="saveThemeBtn">Save</button>
              <button type="button" class="btn btn-small btn-muted hidden" id="cancelThemeBtn">Cancel</button>
            </div>
          </div>
          <p>Select a color layout theme for the full app.</p>
          <div class="form-grid">
            <label>
              Theme
              <select id="appThemeSelect">
                <option value="beige-black">Beige Black</option>
                <option value="sandstone">Sandstone</option>
                <option value="ocean-mist">Ocean Mist</option>
                <option value="forest-sage">Forest Sage</option>
                <option value="charcoal-gold">Charcoal Gold</option>
              </select>
            </label>
          </div>
        </section>
      </section>

      <section class="tab-panel" data-tab-panel="lease-status">
        <section class="card">
          <div class="table-head">
            <h2>Tenant Payments</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small btn-muted" id="expandLeaseStatus" title="Expand All" aria-label="Expand All">▼</button>
              <button type="button" class="btn btn-small btn-muted" id="collapseLeaseStatus" title="Collapse All" aria-label="Collapse All">▲</button>
            </div>
          </div>
          <div id="leaseStatusGroups"></div>
        </section>
      </section>

      <section class="tab-panel" data-tab-panel="maintenance">
        <section class="card hidden" id="maintenanceAddCard">
          <h2 id="maintenanceFormTitle">Add Maintenance Expense</h2>
          <form id="maintenance-form">
            <div class="form-grid">
              <label>
                Month
                <input type="month" id="maintenanceMonth" required />
              </label>
              <label>
                Building
                <select id="maintenanceBuilding" required>
                  <option value="">Select Building</option>
                </select>
              </label>
              <label>
                Category
                <select id="maintenanceCategory" required>
                  <option value="">Select Category</option>
                  <option value="Common Power Bill">Common Power Bill</option>
                  <option value="Security Guard Salary">Security Guard Salary</option>
                  <option value="Trash Charges">Trash Charges</option>
                  <option value="Water Charges">Water Charges</option>
                  <option value="RO Water Filter Charges">RO Water Filter Charges</option>
                  <option value="Other">Other</option>
                </select>
              </label>
              <label>
                Amount (₹)
                <input type="number" id="maintenanceAmount" min="0" step="0.01" required />
              </label>
              <label>
                Notes
                <textarea id="maintenanceNotes" rows="3" placeholder="Optional notes..."></textarea>
              </label>
            </div>
            <div class="actions">
              <button type="submit" class="btn" id="maintenanceSubmitBtn">Save Expense</button>
              <button type="button" class="btn btn-muted" id="cancelMaintenanceEdit">Cancel</button>
            </div>
          </form>
        </section>

        <section class="card">
          <div class="table-head">
            <h2>Monthly Building Maintenance (<span id="maintenanceMonthLabel"></span>)</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small btn-muted" id="expandMaintenance" title="Expand All" aria-label="Expand All">▼</button>
              <button type="button" class="btn btn-small btn-muted" id="collapseMaintenance" title="Collapse All" aria-label="Collapse All">▲</button>
              <button type="button" class="btn btn-small" id="addMaintenanceFromTab">Add Expense</button>
            </div>
          </div>
          <div id="maintenanceGroups"></div>
        </section>
      </section>

      <section class="tab-panel" data-tab-panel="service-providers">
        <section class="card hidden" id="serviceProviderAddCard">
          <h2 id="serviceProviderFormTitle">Add Service Provider</h2>
          <form id="service-provider-form">
            <div class="form-grid">
              <label>
                Service Name
                <input type="text" id="serviceName" required placeholder="Plumbing" />
              </label>
              <label>
                Technician Name
                <input type="text" id="serviceTechnicianName" required placeholder="Ravi Kumar" />
              </label>
              <label>
                Mobile Number
                <input type="tel" id="serviceMobile" placeholder="+91 9876543210" />
              </label>
              <label>
                URL
                <input type="url" id="serviceUrl" placeholder="https://example.com" />
              </label>
              <label>
                Notes
                <textarea id="serviceNotes" rows="3" placeholder="Optional notes..."></textarea>
              </label>
            </div>
            <div class="actions">
              <button type="submit" class="btn" id="serviceProviderSubmitBtn">Save Provider</button>
              <button type="button" class="btn btn-muted" id="cancelServiceProviderEdit">Cancel</button>
            </div>
          </form>
        </section>

        <section class="card">
          <div class="table-head">
            <h2>Service Providers</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small btn-muted" id="expandServiceProviders" title="Expand All" aria-label="Expand All">▼</button>
              <button type="button" class="btn btn-small btn-muted" id="collapseServiceProviders" title="Collapse All" aria-label="Collapse All">▲</button>
              <button type="button" class="btn btn-small" id="addServiceProviderFromTab">Add Provider</button>
            </div>
          </div>
          <div id="serviceProviderGroups"></div>
        </section>
      </section>

      <section class="tab-panel" data-tab-panel="tenant-view" id="tenantPortalPanel">
        <section class="card tenant-portal-card" id="tenantPortalCard">
          <h2>Tenant Portal</h2>
          <p>Please login with your tenant PIN to view your lease and payment details.</p>
        </section>
      </section>

      <section class="tab-panel" data-tab-panel="available-units">
        <section class="card hidden" id="unitAddCard">
          <h2 id="unitFormTitle">Unit Occupancy - Add Unit</h2>
          <form id="unit-form">
            <div class="form-grid">
              <label>
                Building Name
                <input type="text" id="buildingName" required placeholder="Veeramma Residency" />
              </label>
              <label>
                Unit Number
                <input type="text" id="unitNumber" required placeholder="2B" />
              </label>
              <label>
                Occupancy Status
                <select id="occupancyStatus" required>
                  <option value="vacant">Vacant</option>
                  <option value="occupied">Occupied</option>
                </select>
              </label>
              <label>
                Tenant Name
                <select id="unitTenantName">
                  <option value="">Select tenant from Active Tenants</option>
                </select>
              </label>
              <label>
                Notes
                <textarea id="unitNotes" rows="3" placeholder="Unit notes..."></textarea>
              </label>
            </div>
            <div class="actions">
              <button type="submit" class="btn" id="unitSubmitBtn">Save Unit</button>
              <button type="button" class="btn btn-muted" id="cancelUnitEdit">Cancel</button>
            </div>
          </form>
        </section>

        <section class="card">
          <div class="table-head">
            <h2>Units</h2>
            <div class="table-actions">
              <button type="button" class="btn btn-small btn-muted" id="expandUnits" title="Expand All" aria-label="Expand All">▼</button>
              <button type="button" class="btn btn-small btn-muted" id="collapseUnits" title="Collapse All" aria-label="Collapse All">▲</button>
              <button type="button" class="btn btn-small" id="addUnitFromUnits">Add Unit</button>
            </div>
          </div>
          <div id="unitGroups"></div>
        </section>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      (function () {
        const STORAGE_KEY = "rental-manager-data-v1";
        function readLocalUnits() {
          try {
            const raw = localStorage.getItem(STORAGE_KEY);
            if (!raw) return [];
            const parsed = JSON.parse(raw);
            return Array.isArray(parsed.units) ? parsed.units : [];
          } catch {
            return [];
          }
        }
        function renderMetricsFallback() {
          const metricsEl = document.getElementById("metrics");
          if (!metricsEl) return;
          if (metricsEl.dataset.appRendered === "1") return;

          const units = readLocalUnits();
          const total = units.length;
          const occupied = units.filter((unit) => unit && unit.status === "occupied").length;
          const vacant = total - occupied;

          metricsEl.innerHTML = `
            <div class="metrics-row">
              <div class="metric-box">Total Units<strong>${total}</strong></div>
              <div class="metric-box">Occupied Units<strong>${occupied}</strong></div>
              <div class="metric-box">Vacant Units<strong>${vacant}</strong></div>
            </div>
          `;
          metricsEl.dataset.forceFallback = "1";
        }

        window.addEventListener("DOMContentLoaded", function () {
          const metricsEl = document.getElementById("metrics");
          if (!metricsEl) return;
          setTimeout(function () {
            if (metricsEl.dataset.appRendered !== "1") {
              renderMetricsFallback();
            }
          }, 250);
        });
      })();
    </script>
    <script src="config.js?v=20260214cs"></script>
    <script src="utils.js?v=20260214cs"></script>
    <script src="app.js?v=20260214cs"></script>
  </body>
</html>
